apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "taiga.fullname" . }}
  labels:
{{ include "taiga.labels" . | indent 4 }}
data:
  conf.json: |
    {
        "api": "{{ include "taiga.scheme" . }}://{{ include "taiga.hostname" . }}/api/v1/",
        "eventsUrl": null,
        "eventsMaxMissedHeartbeats": 5,
        "eventsHeartbeatIntervalTime": 60000,
        "eventsReconnectTryInterval": 10000,
        "debug": {{ .Values.taiga.debug }},
        "debugInfo": false,
        "defaultLanguage": "en",
        "themes": ["taiga", "material-design"],
        "defaultTheme": "taiga",
        "publicRegisterEnabled": true,
        "feedbackEnabled": true,
        "supportUrl": "{{ .Values.taiga.support }}",
        "privacyPolicyUrl": null,
        "termsOfServiceUrl": null,
        "GDPRUrl": null,
        "maxUploadFileSize": null,
        "contribPlugins": [],
        "tribeHost": null,
        "importers": [],
        "gravatar": {{ .Values.taiga.gravatar }},
        "rtlLanguages": ["fa"]
    }

  local.py: |
    from .development import *
    
    DEBUG = {{- if .Values.taiga.debug }}True{{- else }}False{{- end }}
    
    #ADMINS = (
    #    ("Admin", "example@example.com"),
    #)
    
    DATABASES = {
        "default": {
            "ENGINE": "django.db.backends.postgresql",
            "NAME": "{{ .Values.postgresql.postgresDatabase }}",
            "HOST": "{{ template "postgresql.hostname" . }}",
            "USER": "{{ .Values.postgresql.postgresUser }}",
            "PASSWORD": "{{ .Values.postgresql.postgresPassword }}",
        }
    }
    
    SITES = {
        "api": {
           "scheme": "http",
           "domain": "localhost:8000",
           "name": "api"
        },
        "front": {
           "scheme": "{{ include "taiga.scheme" . }}",
           "domain": "{{- include "taiga.hostname" . }}",
           "name": "front"
        },
    }

